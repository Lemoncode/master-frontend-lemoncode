# Bundle Analyzer

For the next example, let's install and use a bundle analyzer to inspect the internal content of our bundles.

üìå We start from sample `10-code-splitting`.

# Steps to build it

## Prerequisites

Install [Node.js and npm](https://nodejs.org/en/) (20.19.0 || >=22.12.0) if they are not already installed on your computer.

> ‚ö† Verify that you are running at least latest Node LTS version and npm. You can check your current version by running `node -v` and `npm -v` in a terminal/console window. Older versions may produce errors.

## Steps

- We start from `10-code-splitting`. Just copy the project and install:

  ```bash
  npm install
  ```

- Before we proceed with this tool, here goes a brief introduction why they are so useful and widely used:

  > ‚ÑπÔ∏è A bundle analyzer or visualizer is a tool that help us to understand the contents of bundles generated by our bundler. It visually displays how modules and dependecies are distributed within the bundle, showing its relationships and the size of each package, allowing us to:
  >
  > - Reduce the final bundle size.
  > - Detect unnecessary or too heavy dependencies.
  > - Improve load times and user experience.
  >
  > These tools are critical to manually increase application performance before we commit to production, and, therefore, they are usually applied over production bundles only.
  >
  > There are different libraries out there, like `vite-bundle-analyzer`, `rollup-plugin-visualizer`, etc. We will use the first one for this sample.

- These tools are usually plug and play, so their usage is as simple as installing it first:

  ```bash
  npm install vite-bundle-analyzer --save-dev
  ```

- And then, use it as a plugin in `vite.config.js`:

  _vite.config.js_

  ```diff
    import { defineConfig } from "vite";
    import checker from "vite-plugin-checker";
    import react from "@vitejs/plugin-react";
    import tailwindcss from "@tailwindcss/vite";
  + import { analyzer } from "vite-bundle-analyzer";

    export default defineConfig({
      plugins: [
        checker({ typescript: true }),
        tailwindcss(),
        react(),
  +     analyzer(),
      ],
    });
  ```

- Let's see what we get out-of-the-box:

  ```bash
  npm build
  ```

  üîé Check how `localhost:8888` is automatically opened after the build is complete. This is the default behaviour of the package.

  This server renders a report showing an interactive tree map that represents what the the different bundles are made of. It shows every module proportionally to its size.

  You can also expand a search panel to look for specific modules and check its size under different assumptions (gzipped, brotli, etc).

- We can also pass options to the analyzer like:

  ```diff
        react(),
  +     analyzer({
  +       analyzerMode: "static",
  +       openAnalyzer: false,
  +       reportTitle: "Bundle Analysis",
  +       fileName: "bundle-report.html",
  +     }),
      ],
  ```

  > ‚ÑπÔ∏è These settings will make analyzer work in static mode instead of server mode. This way, an `html` document is generated with the desired name, we can open it manually, but no server is created.

- And build again:

  ```bash
    npm build
  ```
